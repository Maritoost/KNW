<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kennisnetwerk Water</title>
<style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 20px; background-color: #f4f4f4; }
    .bubble { width: 200px; height: 200px; border-radius: 50%; display: inline-flex; align-items: center; justify-content: center; color: white; font-size: 20px; font-weight: bold; cursor: pointer; margin: 10px; }
    #droogte { background-color: #ff6347; }
    #waterkwaliteit { background-color: #6ab150; }
    #wateroverlast { background-color: #4682b4; }
    .hidden { display: none; }
    footer { font-style: italic; font-size: 12px; text-align: center; margin-top: 20px; }
    .project { margin: 10px 0; }
    .details { display: none; margin-left: 20px; font-size: 1em; }
    .project-name { font-size: 1em; font-style: italic; cursor: pointer; color: black; text-decoration: underline; }
</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.9/xlsx.full.min.js"></script>
<script>
    let lastVisible = null;

    function toggleVisibility(focusArea) {
        const element = document.getElementById(focusArea + "-projects");
        if (lastVisible && lastVisible !== element) {
            lastVisible.classList.add('hidden');
        }
        element.classList.toggle('hidden');
        lastVisible = element.classList.contains('hidden') ? null : element;
    }

    async function fetchExcelFile(url) {
        const response = await fetch(url);
        const data = await response.arrayBuffer();
        const workbook = XLSX.read(data, { type: 'array' });

        const focusAreas = {
            'Droogte': [],
            'Waterkwaliteit': [],
            'Wateroverlast': []
        };

        workbook.SheetNames.forEach(function (sheetName) {
            const XL_row_object = XLSX.utils.sheet_to_json(workbook.Sheets[sheetName]);
            XL_row_object.forEach(project => {
                focusAreas[project.FocusArea].push(project);
            });
        });

        Object.keys(focusAreas).forEach(focusArea => {
            let output = '<ul>';
            focusAreas[focusArea].forEach(project => {
                output += `
                <li><span class='project-name' onclick="toggleDetails('${project.ID}')">${project.ProjectName}</span>
                    <div id="details-${project.ID}" class="details">
                        <p><strong>Hoofduitvoerder:</strong> ${project.Hoofduitvoerder}</p>
                        <p><strong>Samenvatting:</strong> ${project.Samenvatting}</p>
                        <p><strong>Bereik:</strong> ${project.Bereik}</p>
                        <p><strong>Financieringsbron:</strong> ${project.Financieringsbron}</p>
                        <p><strong>Organisatietype:</strong> ${project.Organisatietype}</p>
                        <p><strong>Samenwerkingspartners:</strong> ${project.Samenwerkingspartners}</p>
                        <p><strong>Gebruiker:</strong> ${project.Gebruiker}</p>
                        <p><strong>Website:</strong> <a href="${project.Website}" target="_blank">${project.Website}</a></p>
                    </div>
                </li>`;
            });
            output += '</ul>';
            document.getElementById(`${focusArea.toLowerCase()}-projects`).innerHTML = output;
        });
    }

    const excelFileUrl = 'https://raw.githubusercontent.com/Maritoost/KNW/main/Split_KennisNetwerk_Projects_version4.xlsx';
    fetchExcelFile(excelFileUrl);

    function toggleDetails(projectId) {
        const details = document.getElementById(`details-${projectId}`);
        details.style.display = details.style.display === 'none' ? 'block' : 'none';
    }
</script>
</head>
<body>
<h1>Kennisnetwerk Water</h1>
<p style="font-size: 24px; font-weight: bold;">Focusgebieden:</p>
<div class="bubble" id="droogte" onclick="toggleVisibility('droogte')">Droogte</div>
<div class="bubble" id="waterkwaliteit" onclick="toggleVisibility('waterkwaliteit')">Waterkwaliteit</div>
<div class="bubble" id="wateroverlast" onclick="toggleVisibility('wateroverlast')">Wateroverlast</div>

<div id='droogte-projects' class='hidden'></div>
<div id='waterkwaliteit-projects' class='hidden'></div>
<div id='wateroverlast-projects' class='hidden'></div>

<footer>
    <p>Â© Kennisnetwerk Water Projecten</p>
</footer>
</body>
</html>
